---
layout: simple
title: 多相流动的直接数值模拟 —— 模型  
date: 2017-05-04
category: comsol
---

## Computational Modeling 
### Simple flows (Re=0 and Re=∞) 简单流
In the limit of either very large or very small viscosity (as measured by the Reynolds number, see Chapter 2.2.6), it is sometimes possible to simplify considerably the flow description by either ignoring inertia completely (Stokes flow) or by ignoring viscous effects completely (inviscid flow). For inviscid flows it is usually further necessary to assume that the flow is irrotational, except at fluid interfaces. Most success has been achieved for disperse flows of un-deformable spheres where, in both these limits, it is possible to reduce the governing equations to a system of coupled ordinary differential equations (ODEs) for the particle positions. 在非常大或非常小的粘度（通过雷诺数测量的参见第2.2.6节）的极限中，有时可以通过完全忽略惯性（斯托克斯流量）或忽略粘性效应来大大简化流量描述完全（不含流）。对于非粘性流，通常还需要假设流体是非旋转的，除了在流体界面处。对于不可变形的球体的分散流体已经取得了最大的成功，在这两个极限中，可以将控制方程式减少到用于粒子位置的耦合常微分方程（ODE）系统。

### Finite Reynolds number flows 有限雷诺数流
For intermediate Reynolds numbers it is necessary to solve the **full Navier- Stokes equations**. Nearly ten years after Birkhoff’s effort to simulate the **inviscid Rayleigh-Taylor problem** by a **boundary integral technique**, the **Marker-and-Cell (MAC) method** was developed at Los Alamos by Harlow and collaborators. In the MAC method the fluid is identified by **marker particles distributed throughout the fluid region** and the **governing equations** solved on **a regular grid that covers both the fluid-filled and the empty part of the domain**.   
对于中间雷诺数，有必要解决**完整**的Navier-Stokes方程。在Birkhoff努力通过**边界积分技术**模拟**无粘性Rayleigh-Taylor问题**近十年之后，Harlow和合作者在Los Alamos开发了**Marker-and-Cell（MAC）方法**。在MAC方法中，流体由**分布在整个流体区域的标记颗粒**和**控制方程**定义，控制方程在**包括了流体填充和空余的部分的规则网格**上解出。

The method was introduced in Harlow and Welch (1965) and two sample computations of the so-called dam breaking problem were shown in that first paper. Several papers quickly followed: Harlow and Welch (1966) examined the Rayleigh-Taylor problem (Fig. 1.8) and Harlow and Shannon (1967) studied the splash when a droplet hits a liquid surface. As originally implemented, the MAC method assumed a free surface so there was only one fluid involved. This required boundary conditions to be applied at the surface and the fluid in the rest of the domain to be completely passive. The Los Alamos group realized, however, that the same methodology could be applied to two-fluid problems. Daly (1969b) computed the evolution of the Rayleigh-Taylor instability for finite density ratios and Daly and Pracht (1968) examined the initial motion of density currents. Surface tension was then added by Daly (1969a) and the method again used to examine the Rayleigh-Taylor instability. The MAC method quickly attracted a small group of followers that used it to study several problems: Chan and Street (1970) applied it to free surface waves, Foote (1973) and Foote (1975) simulated the oscillations of an axisymmetric droplet and the collision of a droplet with a rigid wall, respectively, and Chapman and Plesset (1972) and Mitchell and Hammitt (1973) followed the collapse of a cavitation bubble. While the Los Alamos group did a number of computations of various problems in the sixties and early seventies and Harlow described the basic idea in a Scientific American article (Harlow and Fromm, 1965), the enormous potential of this newfound tool did not, for the most part, capture the fancy of the fluid mechanics research community. Although the MAC method was designed specifically for multi-fluid problems (hence the M for Markers!) it was also the first method to successfully solve the Navier-Stokes equation using the primitive variables (velocity and pressure). The staggered grid used was a novelty and today it is a common practice to refer to any method using a projection based time integration on a staggered grid as a MAC method (see Chapter 3). 
该方法在Harlow和Welch（1965）中引入，并且在第一篇论文中显示了所谓的大坝破坏问题的两个样本计算。 Harlow和Welch（1966）研究了Rayleigh-Taylor问题（图1.8），Harlow和Shannon（1967）研究了当液滴撞击液体表面时的飞溅。如最初实现的那样，MAC方法假设一个自由表面，因此只涉及一个流体。这需要在表面施加边界条件，并且其余部分的流体被完全被动。然而，洛斯阿拉莫斯集团意识到，同样的方法可以应用于双流体问题。 Daly（1969b）计算了有限密度比的Rayleigh-Taylor不稳定性的演化，Daly和Pracht（1968）研究了密度电流的初始运动。然后通过Daly（1969a）加入表面张力，该方法再次用于检验Rayleigh-Taylor不稳定性。 MAC方法很快吸引了一小群使用它来研究几个问题的追随者：陈和街（1970）将其应用于自由表面波，Foote（1973）和Foote（1975）模拟了轴对称液滴的振荡和碰撞分别具有刚性壁的液滴和Chapman和Plesset（1972）和Mitchell和Hammitt（1973），在气蚀泡沫崩溃之后。虽然洛斯阿拉莫斯集团在六十年代初期对多个问题进行了一些计算，哈洛在“美国科学美国”（Harlow and Fromm，1965）中描述了基本思想，但是这种新发现的工具的巨大潜力并没有大部分时间，捕捉了流体力学研究界的奇特。虽然MAC方法是专为多流体问题设计的（因此用于Markers！）也是使用原始变量（速度和压力）成功解决Navier-Stokes方程的第一种方法。所使用的交错网格是一个新奇事物，而今天通常的做法是使用基于投影的时间积分作为MAC方法在交错网格上进行的任何方法（参见第3章）。

The next generation of methods for multi-fluid flows evolved gradually from the MAC method. It was already clear in the Harlow and Welch (1965) paper that the marker particles could cause inaccuracies and of the many algorithmic ideas explored by the Los Alamos group, the replacement of the particles by a marker function soon became the most popular alternative. Thus the Volume-of-Fluid (VOF) method was born. VOF was first discussed in a refereed journal article by Hirt and Nichols (1981) but the method originated earlier (DeBar, 1974; Noh and Woodward, 1976). The basic problem with advecting a marker function is the numerical diffusion resulting from working with a cell-averaged marker function (see Chapter 4). To prevent the marker function from continuing to diffuse, the interface is “reconstructed” in the VOF method in such a way that the marker does not start to flow into a new cell until the current cell is full. The one-dimensional implementation of this idea is essentially trivial and in the early implementation of VOF, the interface in each cell was simply assumed to be a vertical plane for advection in the horizontal direction and a horizontal plane for advection in the vertical direction. This relatively crude reconstruction often lead to large amount of “floatsam and jetsam” (small unphysical droplets that break away from the interface) that degraded the accuracy of the computation. To improve the representation, Youngs (1982) and Ashgriz and Poo (1991) and others introduced more complex reconstructions of the interface, representing it with a line (two dimensions) or a plane (three dimensions) that could be oriented arbitrarily in such a way as to best fit the interface. This increased the complexity of the method considerably but resulted in greatly improved advection of the marker function. Even with higher-order representation of the fluid interface in each cell, the accurate computation of surface tension remained a major problem. In his simulations of surface tension effects on the Rayleigh-Taylor instability, using the MAC method, Daly (1969b) introduced explicit surface markers for this purpose. However, the premise behind the development of the VOF method was to get away from using any kind of surface marker so that the surface tension had to be obtained from the marker function instead. This was achieved by Brackbill et al. (1992) who showed that the curvature (and hence surface tension) could be computed by taking the discrete divergence of the marker function. A “conservative” version of this “continuum surface force” method was developed by Lafaurie et al. (1994). The VOF method has been extended in various ways by a number of authors. In addition to better ways to reconstruct the interface (Rider and Kothe, 1998; Scardovelli and Zaleski, 2000; Aulisa et al., 2007) and compute the surface tension (Renardy and Renardy, 2002; Popinet, 2009), more advanced advection schemes for the momentum equation and better solvers for the pressure equation have been introduced (see Rudman, 1997, for example). Other refinement include the use of sub-cells to keep the interface as sharp as possible (Chen et al., 1997a). VOF methods are in widespread use today and many commercial codes include VOF to track interfaces and free surfaces. Figure 1.9 shows one example of a computation of the splash made when a liquid droplet hits a free surface, done by a modern VOF method. We will discuss the use of VOF extensively in later Chapters. 下一代多流体流动方法逐渐从MAC方法演变而来。在Harlow和Welch（1965）的文章中已经清楚，标记颗粒可能会导致不准确和Los Alamos组探索的许多算法思想，用标记功能替代颗粒很快就成为最流行的替代方案。因此，体积流体（VOF）方法诞生了。 Hirt和Nichols（1981）的评论文章首先讨论了VOF，但是该方法起源于早期（DeBar，1974; Noh和Woodward，1976）。平滑标记功能的基本问题是使用细胞平均标记功能产生的数值扩散（参见第4章）。为了防止标记功能继续扩散，界面在VOF方法中被“重建”，使得标记在当前单元格已满之前不会开始流入新单元格。这个想法的一维实现基本上是微不足道的，并且在早期实现VOF中，每个单元格中的界面被简单地假定为水平方向的平流垂直平面和垂直方向的平流水平面。这种相对粗糙的重建通常导致大量的“floatsam和jetsam”（小的非物理液滴离开界面），这降低了计算的准确性。为了提高代表性，Youngs（1982）和Ashgriz和Poo（1991）等人引入了更复杂的界面重建，用一条线（二维）或一个平面（三维）代表它，可以在这样一个方式最适合接口。这显着增加了方法的复杂性，但是极大地提高了标记功能的平流。即使每个单元中流体界面的高阶表示，表面张力的精确计算仍然是一个主要问题。在他对Rayleigh-Taylor不稳定性的表面张力影响的模拟中，使用MAC方法，Daly（1969b）为此目的引入了明确的表面标记。然而，VOF方法的发展背后的前提是避免使用任何种类的表面标记，从而必须从标记功能获得表面张力。这是由Brackbill等人（1992），他们表明可以通过采取标记函数的离散发散来计算曲率（和表面张力）。这种“连续表面力”方法的“保守”版本由Lafaurie等人开发（1994）。许多作者已经以各种方式扩展了VOF方法。除了更好的方法重建界面（Rider和Kothe，1998; Scardovelli和Zaleski，2000; Aulisa等，2007），并计算表面张力（Renardy和Renardy，2002; Popinet，2009），更先进的对流方案对于动量方程，已经介绍了压力方程的更好的求解器（例如参见Rudman，1997）。其他改进包括使用子单元来保持界面尽可能的清晰（Chen et al。，1997a）。 VOF方法在当今广泛使用，许多商业代码包括用于跟踪接口和自由表面的VOF。图1.9显示了通过现代VOF方法完成的液滴撞击自由表面时的飞溅计算的一个示例。我们将在后面的章节中广泛讨论VOF的使用。

The basic ideas behind the MAC and the VOF methods gave rise to several new approaches in the early nineties. Unverdi and Tryggvason (1992) introduced a Front-Tracking method for multi-fluid flows where the interface was marked by connected marker points. The markers are used to advect the material properties (such as density and viscosity) and to compute surface tension, but the rest of computations is done on a fixed grid as in the VOF method. Although using connected markers to update the material function was new, marker particles had already been used by Daly (1969a) who used them to evaluate surface tension in simulations with the MAC method, in the Immersed-Boundary Method of Peskin (1977) for one-dimensional elastic fibers in homogeneous viscous fluids and in the Vortex-in-Cell method of Tryggvason and Aref (1983) for two-fluid interfaces in a Hele-Shaw cell, for example. The Front-Tracking method of Unverdi and Tryggvason (1992) has been very successful for simulations of finite Reynolds number flows of immiscible fluids and Tryggvason and collaborators have used it to explore a large number of problems. MAC和VOF方法背后的基本思想在九十年代初引入了几种新的方法。 Unverdi和Tryggvason（1992）引入了一种用于多流体的前跟踪方法，其中界面由连接的标记点标记。标记用于平流材料性质（如密度和粘度）并计算表面张力，但其余的计算方法在VOF方法中在固定网格上进行。虽然使用连接的标记来更新材料功能是新的，但Daly（1969a）已经使用了标记颗粒，他们使用它们来评估用MAC方法进行的模拟中的表面张力，在Peskin的浸入式边界方法（1977）中，一个例如，均质粘性流体中的三维弹性纤维和Tryggvason和Aref（1983）的Vortex-in-Cell方法用于Hele-Shaw电池中的双流体界面。 Unverdi和Tryggvason（1992）的前跟踪方法对于混合流体的有限雷诺数流动的模拟非常成功，Tryggvason和协作者已经使用它来探索大量的问题。

The early nineties also saw the introduction of the Level-Set, the CIP, and the Phase-Field methods to track fluid interfaces on stationary grids. The Level-Set method was introduced by Osher and Sethian (1988), but its first use to track fluid interfaces appears to be in the work of Sussman et al. (1994) and Chang et al. (1996) who used it to simulate the rise of bubbles and the fall of droplets in two-dimensions. An axisymmetric version was used subsequently by Sussman and Smereka (1997) to examine the behavior of bubbles and droplets. Unlike the VOF method, where a discontinuous marker function is advected with the flow, in the Level-Set method a continuous level-set function is used. The interface is then identified with the zero contour of the level-set function. To reconstruct the material properties of the flow (density and viscosity, for example) a marker function is constructed from the level-set function. The marker function is given a smooth transition zone from one fluid to the next, thus increasing the regularity of the interface over the VOF method where the interface is confined to only one grid space. However, this mapping from the level-set function to the marker function requires the level-set function to maintain the same shape near the interface and to deal with this problem, Sussman et al. (1994) introduced a reinitialization procedure where the level-set function is adjusted in such a way that its value is equal to the shortest distance to the interface at all times. This step was critical in making level-sets work for fluid-dynamics simulations. Surface tension is found in the same way as in the continuous surface force technique introduced for VOF methods by Brackbill et al. (1992). The early implementation of the Level-Set method did not conserve mass very well and a number of improvements and extension followed its original introduction. Sussman et al. (1998) and Sussman and Fatemi (1999) introduced ways to improved mass conservation, Sussman et al. (1999) coupled level-set track- ing with adaptive grid refinement and a hybrid VOF/Level-Set method was developed by Sussman and Puckett (2000), for example. 九十年代初期，还引入了Level-Set，CIP和Phase-Field方法来跟踪固定网格上的流体接口。 Level-Set方法由Osher和Sethian（1988）引入，但它首先用于跟踪流体界面似乎在Sussman等人的工作中。 （1994）和Chang等人（1996），他用它来模拟气泡的上升和二维液滴的下降。 Sussman和Smereka（1997）随后使用轴对称版本来检查气泡和液滴的行为。与VOF方法不同，其中不连续标记函数与流平行，在Level-Set方法中使用连续的级别集函数。然后用界面功能的零轮廓识别界面。为了重建流动的材料性质（例如，密度和粘度），从水平仪函数构建标记函数。标记函数给出从一个流体到下一个流体的平滑过渡区域，从而通过VOF方法增加界面的规则性，其中界面仅限于一个网格空间。然而，从水平集函数到标记函数的映射需要水平集函数在界面附近保持相同的形状并处理这个问题，Sussman等人（1994）引入了一种重新初始化过程，其中调整水平集函数的方式是使其值等于到达界面的最短距离。这一步对于使液位工作用于流体动力学模拟至关重要。表面张力的发现方式与Brackbill等人为VOF方法引入的连续表面力技术相同。 （1992年）。 Level-Set方法的早期实施并没有很好地保存质量，并且在原始介绍之后进行了一些改进和扩展。 Sussman等人（1998）和Sussman和Fatemi（1999）介绍了改进质量保护的方法，Sussman et al。 （1999），Sussman和Puckett（2000）开发了自适应网格细化和混合VOF / Level-Set方法的水平集跟踪。
